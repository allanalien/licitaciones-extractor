services:
  # Web Service for the API/Interface
  - type: web
    name: licitaciones-extractor-web
    env: python
    buildCommand: pip install -r requirements.txt
    startCommand: gunicorn app:app
    plan: free
    envVars:
      - key: PYTHON_VERSION
        value: 3.9.18
      - key: DATABASE_URL
        sync: false
      - key: LICITA_YA_API_KEY
        sync: false
      - key: LICITA_YA_KEYWORDS
        sync: false
      - key: OPENAI_API_KEY
        sync: false

  # Cron Job for Daily Extraction
  - type: cron
    name: licitaciones-extractor-worker
    env: python
    schedule: "0 6 * * *" # Runs daily at 06:00 UTC
    buildCommand: pip install -r requirements.txt
    startCommand: ./run_daily_extraction.sh
    plan: free
    envVars:
      - key: PYTHON_VERSION
        value: 3.9.18
      - key: DATABASE_URL
        sync: false
      - key: LICITA_YA_API_KEY
        sync: false
      - key: LICITA_YA_KEYWORDS
        sync: false
      - key: OPENAI_API_KEY
        sync: false
